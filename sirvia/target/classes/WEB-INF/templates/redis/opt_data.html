<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>REDIS INDEX</title>

    <!-- Bootstrap core CSS -->
    <script th:src="@{/static/js/jq/jquery.min.js}"></script>
    <link th:href="@{/static/plugins/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
    <script th:src="@{/static/plugins/bootstrap/js/bootstrap.min.js}"></script>
    <link th:href="@{/static/css/redis/opt_data.css}" rel="stylesheet">
    <link th:href="@{/static/plugins/layui/css/layui.css}" rel="stylesheet">

    <link href="../../../static/css/redis/opt_data.css" rel="stylesheet">
    <link href="../../../static/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../static/plugins/layui/css/layui.css" rel="stylesheet">
    <script src="../../../static/plugins/layui/layui.js"></script>
    <script src="../../../static/js/jq/jquery.min.js"></script>
</head>
<body>
<div th:replace="header :: header"></div>
<div class="container">
    <ol class="breadcrumb">
        <li><a th:href="@{/admin}">首页</a></li>
        <li><a href="/admin/redis/index">redis操作</a></li>
        <li><a href="javascript:void(0);">增加数据</a></li>
    </ol>
    <div class="alert alert-success clear-float" role="alert">
        <div class="pull-left alert-left">
            <i class="layui-icon">&#xe6b1;</i>
            <span class="label label-success">添加string</span>
        </div>
        <div class="pull-right">
            <button class="btn btn-success" onclick="addString()">添加</button>
        </div>
    </div>
    <div class="alert alert-info clear-float" role="alert">
        <div class="pull-left alert-left">
            <i class="layui-icon">&#xe66a;</i>
            <span class="label label-info">添加list</span>
        </div>
        <div class="pull-right">
            <button class="btn btn-info" onclick="addList()">添加</button>
        </div>
    </div>
    <div class="alert alert-danger clear-float" role="alert">
        <div class="pull-left alert-left">
            <i class="layui-icon">&#xe756;</i>
            <span class="label label-danger">增加set</span>
        </div>
        <div class="pull-right">
            <button class="btn btn-danger" onclick="addSet()">添加</button>
        </div>
    </div>
    <div class="alert alert-warning clear-float" role="alert">
        <div class="pull-left alert-left">
            <i class="layui-icon">&#xe632;</i>
            <span class="label label-warning">添加zset</span>
        </div>
        <div class="pull-right">
            <button class="btn btn-warning" onclick="addZset()">添加</button>
        </div>
    </div>
    <div class="alert alert-success clear-float" role="alert">
        <div class="pull-left alert-left">
            <i class="layui-icon">&#xe629;</i>
            <span class="label label-success">添加hash</span>
        </div>
        <div class="pull-right">
            <button class="btn btn-success" onclick="addHash()">添加</button>
        </div>
    </div>
</div>
<script>
    // nav栏激活状态
    $(".navbar-right li:eq(0)").addClass("active");

    let layer = null;
    layui.use('layer', function () { //独立版的layer无需执行这一句
        layer = layui.layer; //独立版的layer无需执行这一句
    });

    function addString() {
        layer.open({
            type: 0,
            title: '添加string',
            shade: 0.2,
            offset: '150px',
            area: '500px',
            content: `
                <div class="layui-form">
                    <div class="layui-form-item">
                        <div>键名：</div>
                        <input type="text" name="key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <div>键值：</div>
                        <textarea name="value" placeholder="请输入键值" class="layui-textarea"></textarea>
                    </div>
                </div>
            `,
            btn: ['保存', '取消'],
            yes: function (index, layero) {
                // 获取键名
                let key = $("input[name=key]").val();
                let value = $("textarea[name=value]").val();
                $.ajax({
                    url: "/admin/redis/save_string",
                    type: "post",
                    data: {
                        key,
                        content: value,
                    },
                    success(args) {
                        if (args === "1") {
                            layer.msg("添加成功", {icon: 1});
                            layer.close(index);
                        } else {
                            layer.msg("添加失败", {icon: 5});
                        }
                    },
                });
            },
        });
    }

    function addList() {
        layer.open({
            type: 0,
            title: '添加list',
            shade: 0.2,
            offset: '150px',
            area: '500px',
            content: `
                <div class="layui-form">
                    <div class="layui-form-item">
                        <div>键名：</div>
                        <input type="text" name="key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <div>键值：</div>
                        <textarea name="value" placeholder="请输入键值" class="layui-textarea"></textarea>
                    </div>
                </div>
            `,
            btn: ['保存', '取消'],
            yes: function (index, layero) {
                // 获取键名
                let key = $("input[name=key]").val();
                let value = $("textarea[name=value]").val();
                $.ajax({
                    url: "/admin/redis/add_line_list",
                    type: "post",
                    data: {
                        key,
                        content: value,
                    },
                    success(args) {
                        if (args === "1") {
                            layer.msg("添加成功", {icon: 1});
                            layer.close(index);
                        } else {
                            layer.msg("添加失败", {icon: 5});
                        }
                    },
                });
            },
        });
    }

    function addSet() {
        layer.open({
            type: 0,
            title: '添加set',
            shade: 0.2,
            offset: '150px',
            area: '500px',
            content: `
                <div class="layui-form">
                    <div class="layui-form-item">
                        <div>键名：</div>
                        <input type="text" name="key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <div>键值：</div>
                        <textarea name="value" placeholder="请输入键值" class="layui-textarea"></textarea>
                    </div>
                </div>
            `,
            btn: ['保存', '取消'],
            yes: function (index, layero) {
                // 获取键名
                let key = $("input[name=key]").val();
                let value = $("textarea[name=value]").val();
                $.ajax({
                    url: "/admin/redis/add_line_set",
                    type: "post",
                    data: {
                        key,
                        content: value,
                    },
                    success(args) {
                        if (args === "1") {
                            layer.msg("添加成功", {icon: 1});
                            layer.close(index);
                        } else {
                            layer.msg("添加失败", {icon: 5});
                        }
                    },
                });
            },
        });
    }

    function addZset() {
        layer.open({
            type: 0,
            title: '添加zset',
            shade: 0.2,
            offset: '150px',
            area: '500px',
            content: `
                <div class="layui-form">
                    <div class="layui-form-item">
                        <div>键名：</div>
                        <input type="text" name="key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item">
                        <div>分数：</div>
                        <input type="text" name="score" placeholder="请输入分数" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <div>键值：</div>
                        <textarea name="value" placeholder="请输入键值" class="layui-textarea"></textarea>
                    </div>
                </div>
            `,
            btn: ['保存', '取消'],
            yes: function (index, layero) {
                // 获取键名
                let key = $("input[name=key]").val();
                let score = $("input[name=score]").val().trim();
                let value = $("textarea[name=value]").val();
                $.ajax({
                    url: "/admin/redis/add_line_zset",
                    type: "post",
                    data: {
                        key,
                        score,
                        content: value,
                    },
                    success(args) {
                        if (args === "1") {
                            layer.msg("添加成功", {icon: 1});
                            layer.close(index);
                        } else {
                            layer.msg("添加失败", {icon: 5});
                        }
                    },
                });
            },
        });
    }

    function addHash() {
        layer.open({
            type: 0,
            title: '添加hash',
            shade: 0.2,
            offset: '150px',
            area: '500px',
            content: `
                <div class="layui-form">
                    <div class="layui-form-item">
                        <div>键名：</div>
                        <input type="text" name="key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item">
                        <div>hash键名：</div>
                        <input type="text" name="hash_key" placeholder="请输入键名" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <div>键值：</div>
                        <textarea name="value" placeholder="请输入键值" class="layui-textarea"></textarea>
                    </div>
                </div>
            `,
            btn: ['保存', '取消'],
            yes: function (index, layero) {
                // 获取键名
                let key = $("input[name=key]").val();
                let hashKey = $("input[name=hash_key]").val();
                let value = $("textarea[name=value]").val();
                $.ajax({
                    url: "/admin/redis/add_line_hash",
                    type: "post",
                    data: {
                        key,
                        hashKey,
                        content: value,
                    },
                    success(args) {
                        if (args === "1") {
                            layer.msg("添加成功", {icon: 1});
                            layer.close(index);
                        } else {
                            layer.msg("添加失败", {icon: 5});
                        }
                    },
                });
            },
        });
    }
</script>
</body>
</html>
